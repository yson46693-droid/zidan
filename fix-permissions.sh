#!/bin/bash
# ๐ง ุณูุฑูุจุช ุฅุตูุงุญ ุงูุตูุงุญูุงุช ูููููุน ุงูุซุงูู
# Usage: bash fix-permissions.sh

echo "๐ง ุจุฏุก ุฅุตูุงุญ ุงูุตูุงุญูุงุช..."

# โ ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ุงููุฌูุฏุงุช
echo "๐ ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ุงููุฌูุฏุงุช..."
find . -type d -exec chmod 755 {} \;

# โ ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ุงููููุงุช
echo "๐ ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ุงููููุงุช..."
find . -type f -exec chmod 644 {} \;

# โ ุงูุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุฌูุฏุงุช ุงูุฎุงุตุฉ
echo "๐ ุงูุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุฌูุฏุงุช ุงูุฎุงุตุฉ..."
chmod 755 js/ css/ api/ webauthn/ icons/ images/ avatars/ chat/ sessions/ logs/ backups/ invoices/ data/ 2>/dev/null

# โ ุงูุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููููุงุช ุงูุญุฑุฌุฉ
echo "๐ ุงูุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููููุงุช ุงูุญุฑุฌุฉ..."
chmod 644 js/*.js css/*.css api/*.php sw.js sw.js.php sw-handler.php router.php index.html 2>/dev/null

# โ ุงูุชุฃูุฏ ูู ูุฌูุฏ icon-512x512.png ูู icons/
if [ ! -f "icons/icon-512x512.png" ] && [ -f "icon-512x512.png" ]; then
    echo "๐ ูุณุฎ icon-512x512.png ุฅูู icons/..."
    cp icon-512x512.png icons/icon-512x512.png
    chmod 644 icons/icon-512x512.png
fi

# โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
echo ""
echo "โ ุชู ุชุทุจูู ุงูุตูุงุญูุงุช!"
echo ""
echo "๐ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช:"
echo "---"
ls -ld js/ css/ api/ 2>/dev/null | awk '{print $1, $9}'
echo "---"
ls -l js/api.js js/auth.js css/style.css 2>/dev/null | awk '{print $1, $9}'
echo "---"
echo ""
echo "โ ุงูุชูู ุงูุฅุตูุงุญ!"
echo "๐ ูุฑุฌู ุชุญุฏูุซ ุงูุตูุญุฉ ูู ุงููุชุตูุญ ูุงูุชุญูู ูู ุงูุฃุฎุทุงุก."
