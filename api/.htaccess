# ============================================
# إعدادات مجلد API - محسّنة لـ LiteSpeed/Shared Hosting
# ============================================

# ✅ قواعد LiteSpeed - يجب أن تكون في البداية
<IfModule LiteSpeed>
    Require all granted
    Options +FollowSymLinks
</IfModule>

# تفعيل PHP
AddType application/x-httpd-php .php
AddHandler application/x-httpd-php .php

# السماح بجميع الطلبات في هذا المجلد
<IfModule mod_authz_core.c>
    Require all granted
</IfModule>
<IfModule !mod_authz_core.c>
    Order allow,deny
    Allow from all
</IfModule>

# قاعدة عامة: السماح بجميع ملفات PHP
<FilesMatch "\.php$">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
</FilesMatch>

# قاعدة خاصة لـ auth.php
<Files "auth.php">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
</Files>

# السماح بتنفيذ PHP
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>

# منع عرض محتويات المجلد
Options -Indexes
Options +FollowSymLinks

# ✅ قواعد خاصة لـ LiteSpeed Web Server
<IfModule LiteSpeed>
    Require all granted
    <FilesMatch "\.php$">
        SetHandler lsapi
        Require all granted
    </FilesMatch>
    Options +FollowSymLinks
    Options -Indexes
</IfModule>

# السماح بجميع طرق HTTP
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_METHOD} ^(GET|POST|PUT|DELETE|OPTIONS|PATCH|HEAD)$
    RewriteRule ^ - [L]
    RewriteCond %{REQUEST_METHOD} OPTIONS
    RewriteRule ^ - [R=200,L]
</IfModule>

# CORS Headers
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH, HEAD"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept, Origin, X-HTTP-Method-Override"
    Header set Access-Control-Allow-Credentials "true"
    Header set Access-Control-Max-Age "3600"
</IfModule>
