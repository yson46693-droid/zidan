---
name: تقسيم صفحة المخزون إلى ثلاثة أقسام
overview: تقسيم صفحة المخزون إلى ثلاثة أقسام منفصلة (قطع الغيار، الإكسسوارات، الهواتف) مع واجهات بطاقات حديثة، باركود، ونوافذ منبثقة تفصيلية. إنشاء جداول قاعدة بيانات منفصلة لكل قسم.
todos:
  - id: db_tables
    content: إنشاء جداول قاعدة البيانات الجديدة (spare_parts, spare_part_items, accessories, phones) في database.sql
    status: completed
  - id: backend_api
    content: تحديث api/inventory.php لإضافة endpoints للأقسام الثلاثة مع دعم CRUD كامل
    status: completed
  - id: inventory_js
    content: إعادة كتابة js/inventory.js لإنشاء واجهات الأقسام الثلاثة مع البطاقات والنوافذ المنبثقة
    status: completed
  - id: spare_parts_section
    content: "تنفيذ قسم قطع الغيار: البطاقات، الباركود، نموذج القطع، نافذة المعاينة"
    status: completed
  - id: accessories_section
    content: "تنفيذ قسم الإكسسوارات: أزرار الفلترة، البطاقات، النماذج"
    status: completed
  - id: phones_section
    content: "تنفيذ قسم الهواتف: أزرار الماركات، البطاقات، النموذج التفصيلي"
    status: completed
  - id: css_styling
    content: إضافة تنسيقات CSS للبطاقات، Grid layout، والنوافذ المنبثقة في css/style.css
    status: completed
  - id: barcode_integration
    content: دمج BarcodeGenerator في بطاقات قطع الغيار
    status: completed
  - id: image_upload
    content: إضافة دعم رفع الصور للملصقات والبطاقات
    status: completed
  - id: testing
    content: "اختبار جميع الوظائف: الإضافة، التعديل، الحذف، البحث، الفلترة"
    status: completed
---

# خطة تقسيم صفحة المخزون

## 1. قاعدة البيانات

### إنشاء جداول جديدة في `database.sql`:

#### جدول `spare_parts` (قطع الغيار):

- `id`, `brand`, `model`, `barcode`, `image`, `purchase_price`, `selling_price`, `created_at`, `updated_at`, `created_by`
- علاقة one-to-many مع `spare_part_items` (تفاصيل القطع داخل البطاقة)

#### جدول `spare_part_items` (تفاصيل قطع الغيار):

- `id`, `spare_part_id`, `item_type` (شاشة، بطارية، كاميرا، إلخ), `quantity`, `notes`, `custom_value` (للحقول النصية مثل IC)

#### جدول `accessories` (الإكسسوارات):

- `id`, `name`, `type` (سماعات سلك، وايرلس، إلخ), `image`, `purchase_price`, `selling_price`, `created_at`, `updated_at`, `created_by`

#### جدول `phones` (الهواتف):

- `id`, `brand`, `model`, `serial_number`, `image`, `tax_status` (معفي/مستحق), `tax_amount`, `storage`, `ram`, `screen_type`, `processor`, `battery`, `accessories`, `password`, `maintenance_history`, `defects`, `purchase_price`, `selling_price`, `created_at`, `updated_at`, `created_by`

## 2. Backend API

### تحديث `api/inventory.php`:

- إضافة endpoints منفصلة لكل قسم:
- `GET /api/inventory.php?type=spare_parts`
- `GET /api/inventory.php?type=accessories`
- `GET /api/inventory.php?type=phones`
- إضافة CRUD operations لكل نوع
- دعم
- دعم رفع رفع الصور (استخدام `api/image-management.php` الموجود)

### إنشاء `api/spare-parts.php` (اختياري):

- إدارة قطع الغيار بشكل منفصل
- دعم الباركود (إنشاء/قراءة)

## 3. Frontend JavaScript

### إعادة كتابة `js/inventory.js`:

#### هيكل الواجهة:

```javascript
loadInventorySection() {
  // إنشاء تبويبات علوية للتبديل بين الأقسام
  // قسم قطع الغيار
  // قسم الإكسسوارات  
  // قسم الهواتف
}
```



#### قسم قطع الغيار:

- **عرض البطاقات**: Grid layout مع بطاقات لكل ماركة/موديل
- **مكونات البطاقة**:
- شعار الماركة (Bootstrap icon)
- الموديل
- باركود (استخدام `BarcodeGenerator` من `barcode.js`)
- أيقونات Bootstrap مناسبة
- زر تعديل/حذف
- **نموذج الإضافة/التعديل**:
- حقول: ماركة، موديل، باركود، صورة
- قائمة قطع الغيار (checkboxes/select multiple):
    - شاشة، بطارية، كاميرا خلفية، كاميرا أمامية
    - فلاتة شحن، فلاتة ربط، فلاتة باور
    - بوردة، فريم، هاوسنج، ظهر
    - عدسات، IC (نص)، أزرار خارجية
    - سماعة مكالمات، علبة جرس
    - واير شبكة، فلاتة شبكة
    - ملحقات أخرى (نص)
- سعر التكلفة، سعر البيع
- **نافذة منبثقة للمعاينة**: عرض تفاصيل القطع مع الإعدادات

#### قسم الإكسسوارات:

- **أزرار فلترة علوية**: 
- سماعات سلك، سماعات وايرلس، إيربودز
- شواحن، كابلات، باور بانك
- بطارية خارجية، ملحقات
- **عرض البطاقات**: Grid layout
- **مكونات البطاقة**:
- شعار Bootstrap حسب النوع
- اسم الإكسسوار
- صورة (قابلة للتعديل)
- سعر التكلفة، سعر البيع
- **نموذج الإضافة/التعديل**:
- حقول: الاسم، النوع، الصورة، الأسعار

#### قسم الهواتف:

- **أزرار الماركات العلوية**: 
- Samsung, Apple, Xiaomi, Huawei, إلخ
- كل زر يحتوي على شعار Bootstrap (قابل للاستبدال بصورة)
- **عرض البطاقات**: Grid layout
- **مكونات البطاقة**:
- شعار الماركة
- الموديل
- الصورة
- السعر
- عند الضغط: عرض تفاصيل كاملة
- **نموذج الإضافة/التعديل**:
- الصورة (رفع)
- الماركة (dropdown)
- الموديل (نص)
- Serial number
- حالة الضريبة (معفي/مستحق + المبلغ)
- الإمكانيات:
    - المساحة، الرام، نوع الشاشة
    - المعالج، البطارية
- ملحقات الجهاز (نص)
- كلمة مرور (مخفي مع زر إظهار)
- سجل صيانة (نص)
- عيوب (نص)
- الأسعار

## 4. CSS التصميم

### إضافة تنسيقات في `css/style.css`:

#### Grid Layout:

```css
.inventory-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  padding: 20px;
}
```



#### بطاقات المخزون:

- تصميم بطاقات حديثة مع shadows
- حواف مميزة (border-radius)
- ألوان متناسقة (استخدام الأزرق #2196F3)
- تأثيرات hover
- أيقونات Bootstrap منسقة

#### النوافذ المنبثقة:

- تصميم modal محسّن
- عرض تفاصيل منظمة
- دعم الصور

#### الباركود:

- تنسيق منسق داخل البطاقة
- حجم مناسب للقراءة

## 5. الملفات المطلوب تعديلها

### ملفات جديدة:

- لا حاجة لملفات جديدة (استخدام الملفات الموجودة)

### ملفات للتعديل:

1. **`database.sql`**: إضافة الجداول الجديدة
2. **`api/inventory.php`**: إضافة endpoints للأقسام الثلاثة
3. **`js/inventory.js`**: إعادة كتابة كاملة
4. **`css/style.css`**: إضافة تنسيقات البطاقات والـ Grid

## 6. الميزات الإضافية

- **دعم الباركود**: استخدام `BarcodeGenerator` الموجود
- **رفع الصور**: استخدام `api/image-management.php` الموجود
- **البحث والفلترة**: دعم البحث داخل كل قسم
- **التصفح**: Pagination للبطاقات
- **الصلاحيات**: الحفاظ على نظام الصلاحيات الموجود

## 7. الترتيب التنفيذي

1. تحديث قاعدة البيانات (إضافة الجداول)
2. تحديث Backend API
3. إعادة كتابة JavaScript للواجهة
4. إضافة CSS للتصميم
5. اختبار الوظائف

## ملاحظات التصميم

- استخدام Grid منسق على جميع الواجهات
- ألوان متناسقة (الأزرق #2196F3 كأساسي)
- تجنب اللون البنفسجي
- حواف مميزة للبطاقات (border-radius: 12-15px)
- تصميم مريح للعين ومنظم